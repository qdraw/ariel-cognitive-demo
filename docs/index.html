<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Emotion-dection and Classify - powered by Colours AI</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<!-- <link rel="stylesheet" href="css/dropzone_basic.css"> -->
		<link rel="stylesheet" href="css/style.css">
		<link rel="icon" type="image/png" href="img/favicon.png" />
		<meta name="csrf-token" content="COLOURSAIROCKS">
	</head>
<body>
	<div id="header">
		<img src="img/colours.gif" alt="Colours logo" height="50">
	</div>

	<div class="preloader">
		<img src="img/preloader.svg" width="100px" height="100px">
	</div>

	<h1>Emotion-dection</h1>

	<form id="upload-widget" action="upload" method="post" class="dropzone">
		<div class="fallback">
			<input name="file" type="file" />
		</div>
	</form>

	<script type="text/javascript" src="js/dropzone.js"></script>
	<script type="text/javascript">

	document.addEventListener("DOMContentLoaded", function(event){

		getConfig();

		function getConfig() {
			var xhr = new XMLHttpRequest();
			xhr.open('GET', "config.json", true);
			xhr.onload = function () {
				if (xhr.status === 200 || xhr.status === 304) {
					try {
						data = JSON.parse(xhr.responseText);
					} catch (e) {
						data = undefined;
					}

					if (data !== undefined) {
						getBackendServer(data.server,data.inittoken);
					}

				}
			};
			xhr.send(null);
		}

		function getBackendServer(server,inittoken) {
			console.log("server");
		}



	});

	Dropzone.options.uploadWidget = {
		paramName: 'file',
		maxFilesize: 3, // MB
		maxFiles: 1,
		dictDefaultMessage: 'Drag an image here to upload, or click to select one',
		headers: {
			'x-csrf-token': document.querySelectorAll('meta[name=csrf-token]')[0].getAttributeNode('content').value,
		},
		acceptedFiles: 'image/*',
		init: function() {
			this.on('success', function( file, resp ){
				console.log( file );
				console.log( resp );
			});
			this.on('thumbnail', function(file) {
				if ( file.width < 640 || file.height < 480 ) {
					file.rejectDimensions();
				} else {
					file.acceptDimensions();
				}
			});
		},
		accept: function(file, done) {
			file.acceptDimensions = done;
			file.rejectDimensions = function() {
				done('The image must be at least 640 x 480px')
			};
		}
	};
	// Dropzone.autoDiscover = false;
	//
	// document.addEventListener("DOMContentLoaded", function(event){
	//
	// 	var uploader = new Dropzone('#upload-widget');
	// 	uploader.on('thumbnail', function( file){
	// 	  console.log(file.width);
	// 	});
	//
	// 	uploader.on('success', function( file, resp ){
	// 	  console.log("Sdf");
	// 	});
	//
	//
	// });


	</script>

  </body>
</html>
